##### 抽象原型角色
```java
public abstract class Prototype {

   public abstract Object copy();
}
```
##### 具体原型角色
```java
public class Sheep extends Prototype {

    String name;

    SheepInfo info;

    public Sheep(String name) {
        this.name = name;
    }

    public Sheep(Sheep sheep) {
        this.name = sheep.name;
        //TODO this.info = (SheepInfo) sheep.info.copy();
        this.info = sheep.info;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public SheepInfo getInfo() {
        return info;
    }

    public void setInfo(SheepInfo info) {
        this.info = info;
    }

    @Override
    public Object copy() {
        return new Sheep(this);
    }

    @Override
    public String toString() {
        return "Sheep{" +
                "name='" + name + '\'' +
                ", info=" + info + '}';
    }


    public static class SheepInfo extends Prototype {

        String birthday;

        public SheepInfo(String birthday) {
            this.birthday = birthday;
        }

        public SheepInfo(SheepInfo sheepInfo) {
            this.birthday = sheepInfo.birthday;
        }


        public String getBirthday() {
            return birthday;
        }

        public void setBirthday(String birthday) {
            this.birthday = birthday;
        }

        @Override
        public Object copy() {
            return new SheepInfo(this);
        }

        @Override
        public String toString() {
            return "SheepInfo{" +
                    "birthday='" + birthday + '\'' +
                    '}';
        }
    }
}
```
##### 测试
```java
public class PrototypeTest {

    public static void main(String[] args) {

        Sheep.SheepInfo sheepInfo = new Sheep.SheepInfo("19930205");

        Sheep sheep = new Sheep("unkown");
        sheep.setInfo(sheepInfo);

        Sheep sheep1 = (Sheep) sheep.copy();
        sheep1.getInfo().setBirthday("19960705");

        Sheep sheep2 = (Sheep) sheep.copy();
        sheep2.setName("Dolly");

        System.out.println(sheep);
        System.out.println(sheep1);
        System.out.println(sheep2);
    }

}
```
##### 测试结果
```
Sheep{name='unkown', info=SheepInfo{birthday='19960705'}}
Sheep{name='unkown', info=SheepInfo{birthday='19960705'}}
Sheep{name='Dolly', info=SheepInfo{birthday='19960705'}}
```
```
note:测试结果说明demo实现的是浅克隆，若想实现深克隆的效果，可把Sheep类中14行代码改为13行
```
##### 改造
```java
public Sheep(Sheep sheep) {
        this.name = sheep.name;
        this.info = (SheepInfo) sheep.info.copy();
        //this.info = sheep.info;
    }
```
##### 改造后的测试结果
```
Sheep{name='unkown', info=SheepInfo{birthday='19930205'}}
Sheep{name='unkown', info=SheepInfo{birthday='19960705'}}
Sheep{name='Dolly', info=SheepInfo{birthday='19930205'}}
```

##### 浅克隆和深克隆
- ###### 浅克隆
```
只克隆按值传递的数据（比如基本数据类型、String类型），而不复制它所引用的对象，换言之，所有的对其他对象的引用仍然指向原来的对象。
```
- ###### 深克隆
```
除了浅克隆要克隆的值外，还克隆引用类型的数据。那些引用其他对象的变量将指向被复制过的新对象，而不再是原有的那些被引用的对象。换言之，深克隆把要复制的对象所引用的对象都复制了一遍，而这种对被引用到的对象的复制叫做间接复制。
深克隆要深入到多少层，是一个不易确定的问题。在决定以深克隆的方式复制一个对象的时候，必须决定对间接复制的对象时采取浅克隆还是继续采用深克隆。因此，在采取深克隆时，需要决定多深才算深。此外，在深克隆的过程中，很可能会出现循环引用的问题，必须小心处理。
```
##### 序列化方式实现深克隆
```java
/**
 * 实现Serializable接口
 */
public abstract class Prototype implements Serializable{

   public abstract Object copy();
}
```
```java
public class Sheep extends Prototype {

    ...

    /**
     * 序列化方式实现深克隆
     * @return
     * @throws IOException
     * @throws ClassNotFoundException
     */
    public  Object deepClone() throws IOException, ClassNotFoundException{
        ByteArrayOutputStream bos = new ByteArrayOutputStream();
        ObjectOutputStream oos = new ObjectOutputStream(bos);
        oos.writeObject(this);
        ByteArrayInputStream bis = new ByteArrayInputStream(bos.toByteArray());
        ObjectInputStream ois = new ObjectInputStream(bis);
        return ois.readObject();
    }

    public static class SheepInfo extends Prototype {
        ...
    }
}
```
##### 测试
```java
public class PrototypeTest {

    public static void main(String[] args) throws IOException, ClassNotFoundException {

        Sheep.SheepInfo sheepInfo = new Sheep.SheepInfo("19930205");

        Sheep sheep = new Sheep("unkown");
        sheep.setInfo(sheepInfo);

        Sheep sheep1 = (Sheep) sheep.deepClone();
        sheep1.getInfo().setBirthday("19960705");

        Sheep sheep2 = (Sheep) sheep.deepClone();
        sheep2.getInfo().setBirthday("19980705");

        System.out.println(sheep);
        System.out.println(sheep1);
        System.out.println(sheep2);
    }

}
```
```
Sheep{name='unkown', info=SheepInfo{birthday='19930205'}}
Sheep{name='unkown', info=SheepInfo{birthday='19960705'}}
Sheep{name='unkown', info=SheepInfo{birthday='19980705'}}
```

---

##### 代码实现
```java
/**
 * 实现Cloneable接口，并重写clone方法
 */
public class Monkey implements Cloneable{

    private String name;
    private GoldenCudgel goldenCudgel;

    public Monkey(String name, GoldenCudgel goldenCudgel) {
        this.name = name;
        this.goldenCudgel = goldenCudgel;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public GoldenCudgel getGoldenCudgel() {
        return goldenCudgel;
    }

    public void setGoldenCudgel(GoldenCudgel goldenCudgel) {
        this.goldenCudgel = goldenCudgel;
    }

    @Override
    public Object clone() throws CloneNotSupportedException {
        Monkey monkey = (Monkey) super.clone();
        monkey.setGoldenCudgel((GoldenCudgel) getGoldenCudgel().clone());
        return monkey;
    }

    @Override
    public String toString() {
        return "Monkey{" +
                "name='" + name + '\'' +
                ", goldenCudgel=" + goldenCudgel +
                '}';
    }

    public static class GoldenCudgel implements Cloneable{

        private double hight;
        private double radius;

        public GoldenCudgel(double hight, double radius) {
            this.hight = hight;
            this.radius = radius;
        }

        public double getHight() {
            return hight;
        }

        public void setHight(double hight) {
            this.hight = hight;
        }

        public double getRadius() {
            return radius;
        }

        public void setRadius(double radius) {
            this.radius = radius;
        }

        @Override
        public Object clone() throws CloneNotSupportedException {
            return super.clone();
        }

        @Override
        public String toString() {
            return "GoldenCudgel{" +
                    "hight=" + hight +
                    ", radius=" + radius +
                    '}';
        }
    }
}
```
##### 测试
```java
    @Test
    public void test() throws CloneNotSupportedException {
        Monkey.GoldenCudgel goldenCudgel = new Monkey.GoldenCudgel(100, 5);
        Monkey monkey = new Monkey("齐天大圣", goldenCudgel);

        Monkey monkey1 = (Monkey) monkey.clone();
        monkey1.getGoldenCudgel().setHight(200);

        System.out.println(monkey);
        System.out.println(monkey1);
    }
```
##### 测试结果
```
Monkey{name='齐天大圣', goldenCudgel=GoldenCudgel{hight=100.0, radius=5.0}}
Monkey{name='齐天大圣', goldenCudgel=GoldenCudgel{hight=200.0, radius=5.0}}
```